{"version":3,"sources":["webpack:///webpack/bootstrap 68dfebe0fd0d5ad30a12","webpack:///./app/javascript/packs/modules/ptTask.js","webpack:///./app/javascript/packs/common/inViewport.js","webpack:///./app/javascript/packs/entries/ptTask.js","webpack:///./app/javascript/packs/common/utilities.js?c767*","webpack:///./app/javascript/packs/common/toggleScroll.js?b622*"],"names":["initPtTask","disposePtTask","stack","torrentDetailEl","document","getElementsByClassName","torrentDetailWrapEl","searchInputEl","getElementById","ptTasks","queryId","ev","q","value","length","renderList","push","fetch","credentials","headers","then","res","json","shouldContinue","data","getTorrentDetail","id","source","text","innerHTML","classList","remove","getTtgCover","el","dataset","coverEl","Array","prototype","slice","call","children","filter","contains","style","backgroundImage","indexOf","arr","forEach","torrentSource","checkAvailability","torrentId","coverPic","chsTitle","engTitle","torrentCategory","torrentSize","peersCount","downloadingCount","addTaskHtml","resEle","join","querySelectorAll","checkInViewport","validSize","str","regex","exec","delegateClick","evt","target","apt","ptd","tdpc","closest","addPtTask","showTorrentDetail","closePopup","tagName","forbidExtLink","preventDefault","alert","wrapEl","add","goToTaskDetail","task_id","A","spf","navigate","window","location","origin","ele","tdWrap","debouncedQueryId","debouncedCheckInViewport","addEventListener","removeEventListener","isInViewport","elem","bounding","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","init","gc","currentName","destroy","isEmpty","cloneObj","mergeObj","addPrefixToObj","wrapObj","strToDom","insertAfter","debounce","isStrictMode","generateUUID","obj","Object","keys","JSON","parse","stringify","obj1","obj2","newObj","key","hasOwnProperty","prefix","wrapper","tmpEle","createElement","returnDom","newNode","referenceNode","parentNode","insertBefore","nextSibling","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","isStrict","replace","c","r","Math","random","v","toString","disableScroll","enableScroll","e","event","returnValue","preventDefaultForScrollKeys","keyCode","onwheel","onmousewheel","ontouchmove","onkeydown"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;QC+KgBA,U,GAAAA,U;QASAC,a,GAAAA,a;;AAxPhB;;AACA;;;;AACA;;;;AACA,IAAMC,QAAQ,EAAd;AACA,IAAMC,kBAAkBC,SAASC,sBAAT,CACtB,sBADsB,EAEtB,CAFsB,CAAxB;AAGA,IAAMC,sBAAsBF,SAASC,sBAAT,CAC1B,qBAD0B,EAE1B,CAF0B,CAA5B;AAGA,IAAME,gBAAgBH,SAASI,cAAT,CAAwB,YAAxB,CAAtB;;AAEA,IAAIC,UAAU,EAAd;AACA,SAASC,OAAT,CAAiBC,EAAjB,EAAqB;AACnB,MAAMC,IAAIL,cAAcM,KAAxB;AACA,MAAI,CAACD,EAAEE,MAAP,EAAe;AACbC,eAAW,EAAX;AACA;AACD;AACDb,QAAMc,IAAN,CAAWJ,CAAX;AACAK,+BAA2BL,CAA3B,EAAgC;AAC9BM,iBAAa,aADiB;AAE9BC,aAAS;AACP,sBAAgB;AADT;AAFqB,GAAhC,EAMGC,IANH,CAMQ;AAAA,WAAOC,IAAIC,IAAJ,EAAP;AAAA,GANR,EAOGF,IAPH,CAOQ,gBAAQ;AACZG,mBAAeC,IAAf,EAAqBZ,CAArB;AACD,GATH;AAUD;;AAED,SAASa,gBAAT,OAA0C;AAAA,MAAdC,EAAc,QAAdA,EAAc;AAAA,MAAVC,MAAU,QAAVA,MAAU;;AACxC,MAAID,MAAM,IAAN,IAAcC,UAAU,IAA5B,EAAkC;AAChC;AACD;AACDV,wCAAoCS,EAApC,gBAAiDC,MAAjD,EAA2D;AACzDT,iBAAa,aAD4C;AAEzDC,aAAS;AACP,sBAAgB;AADT;AAFgD,GAA3D,EAMGC,IANH,CAMQ;AAAA,WAAOC,IAAIO,IAAJ,EAAP;AAAA,GANR,EAOGR,IAPH,CAOQ,gBAAQ;AACZjB,oBAAgB0B,SAAhB,GAA4BL,IAA5B;AACAlB,wBAAoBwB,SAApB,CAA8BC,MAA9B,CAAqC,QAArC;AACD,GAVH;AAWD;;AAED,SAASC,WAAT,CAAqBC,EAArB,EAAyB;AACvB,MAAMP,KAAKO,GAAGC,OAAH,CAAWR,EAAtB;AACA,MAAMC,SAASM,GAAGC,OAAH,CAAWP,MAA1B;AACA,MAAMQ,UAAUC,MAAMC,SAAN,CAAgBC,KAAhB,CACbC,IADa,CACRN,GAAGO,QADK,EAEbC,MAFa,CAEN;AAAA,WAAMR,GAAGH,SAAH,CAAaY,QAAb,CAAsB,eAAtB,CAAN;AAAA,GAFM,EAEwC,CAFxC,CAAhB;AAGA,MAAIP,QAAQQ,KAAR,CAAcC,eAAd,CAA8BC,OAA9B,CAAsC,UAAtC,MAAsD,CAAC,CAA3D,EAA8D;AAC5D;AACD;AACD,SAAO5B,iCAA+BS,EAA/B,gBAA4CC,MAA5C,EAAsD;AAC3DT,iBAAa,aAD8C;AAE3DC,aAAS;AACP,sBAAgB;AADT;AAFkD,GAAtD,EAMJC,IANI,CAMC;AAAA,WAAOC,IAAIO,IAAJ,EAAP;AAAA,GAND,EAOJR,IAPI,CAOC,gBAAQ;AACZ,QAAII,QAAQ,IAAR,IAAgBA,SAAS,MAAzB,IAAmCA,SAAS,EAAhD,EAAoD;AAClD;AACD;AACDW,YAAQQ,KAAR,CAAcC,eAAd,YAAuCpB,IAAvC;AACD,GAZI,CAAP;AAaD;AACD,SAASD,cAAT,CAAwBC,IAAxB,EAA8BZ,CAA9B,EAAiC;AAC/B,MAAIV,MAAMY,MAAN,GAAe,CAAf,IAAoBF,MAAMV,MAAMA,MAAMY,MAAN,GAAe,CAArB,CAA9B,EAAuD;AACrDC,eAAWS,IAAX;AACD;AACF;AACD,SAAST,UAAT,CAAoB+B,GAApB,EAAyB;AACvB,MAAMzB,MAAM,EAAZ;AACAyB,MAAIC,OAAJ,CAAY,cAAM;AAChB1B,QAAIL,IAAJ,oEAEIiB,GAAGe,aAAH,GAAmBf,GAAGe,aAAtB,GAAsC,EAF1C,WAGMC,kBAAkBhB,EAAlB,IAAwB,EAAxB,GAA6B,eAHnC,sBAIEA,GAAGiB,SAJL,yBAKkBjB,GAAGe,aALrB,gFAOMf,GAAGkB,QAPT,sFAWclB,GAAGmB,QAXjB,+BAYcnB,GAAGoB,QAZjB,oJAecpB,GAAGqB,eAfjB,oGAkBcrB,GAAGsB,WAlBjB,2GAqBctB,GAAGuB,UArBjB,2HAwBcvB,GAAGwB,gBAxBjB,+KA8BQxB,GAAGe,aA9BX,4HAiCqBf,GAAGe,aAjCxB,gCAkCiBf,GAAGiB,SAlCpB,uDAmCQD,kBAAkBhB,EAAlB,IAAwByB,YAAYzB,EAAZ,CAAxB,GAA0C,EAnClD;AAuCD,GAxCD;AAyCA0B,SAAO9B,SAAP,GAAmBR,IAAIuC,IAAJ,CAAS,EAAT,CAAnB;AACAnD,YAAU2B,MAAMC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CACRnC,SAASyD,gBAAT,CAA0B,kBAA1B,CADQ,CAAV;AAGAC;AACA;AACD;;AAED,SAASJ,WAAT,CAAqBzB,EAArB,EAAyB;AACvB,wFACEA,GAAGiB,SADL,wBAEkBjB,GAAGe,aAFrB;AAGD;;AAED,SAASC,iBAAT,CAA2BhB,EAA3B,EAA+B;AAC7B,MAAIA,GAAGuB,UAAH,GAAgB,CAAhB,IAAqBO,UAAU9B,GAAGsB,WAAb,CAAzB,EAAoD;AAClD,WAAO,IAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAP;AACD;AACF;;AAED,SAASQ,SAAT,CAAmBC,GAAnB,EAAwB;AACtB,MAAMC,QAAQ,iBAAd;AACA,MAAM5C,MAAM4C,MAAMC,IAAN,CAAWF,GAAX,CAAZ;AACA,MAAI3C,IAAI,CAAJ,MAAW,IAAf,EAAqB;AACnB,QAAI,CAACA,IAAI,CAAJ,CAAD,GAAU,EAAd,EAAkB;AAChB,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAED,SAAS8C,aAAT,CAAuBxD,EAAvB,EAA2B;AACzB,MAAMyD,MAAMzD,GAAG0D,MAAf;AACA,MAAIC,YAAJ;AAAA,MAASC,YAAT;AAAA,MAAcC,aAAd;AACA;AACA,MAAIJ,IAAItC,SAAJ,CAAcY,QAAd,CAAuB,aAAvB,CAAJ,EAA2C;AACzC4B,UAAMF,GAAN;AACD,GAFD,MAEO;AACLE,UAAMF,IAAIK,OAAJ,CAAY,cAAZ,CAAN;AACD;AACD,MAAIH,GAAJ,EAAS;AACPI,cAAUJ,GAAV;AACA;AACD;;AAED;AACA,MAAIF,IAAItC,SAAJ,CAAcY,QAAd,CAAuB,mBAAvB,CAAJ,EAAiD;AAC/C6B,UAAMH,GAAN;AACD,GAFD,MAEO;AACLG,UAAMH,IAAIK,OAAJ,CAAY,oBAAZ,CAAN;AACD;AACD,MAAIF,GAAJ,EAAS;AACPI,sBAAkBJ,GAAlB;AACA;AACD;;AAED;AACA,MAAIH,IAAItC,SAAJ,CAAcY,QAAd,CAAuB,4BAAvB,CAAJ,EAA0D;AACxD8B,WAAOJ,GAAP;AACD,GAFD,MAEO;AACLI,WAAOJ,IAAIK,OAAJ,CAAY,6BAAZ,CAAP;AACD;AACD,MAAID,IAAJ,EAAU;AACRI,eAAWJ,IAAX;AACA;AACD;;AAED;AACA,MAAIJ,IAAIS,OAAJ,KAAgB,GAAhB,IAAuBT,IAAIK,OAAJ,CAAY,uBAAZ,CAA3B,EAAiE;AAC/DK,kBAAcnE,EAAd;AACA;AACD;AACF;;AAED,SAASmE,aAAT,CAAuBnE,EAAvB,EAA2B;AACzBA,KAAGoE,cAAH;AACAC,QAAM,yBAAN;AACD;;AAED,SAASJ,UAAT,CAAoB3C,EAApB,EAAwB;AACtB,MAAMgD,SAAShD,GAAGwC,OAAH,CAAW,sBAAX,CAAf;AACAQ,SAAOnD,SAAP,CAAiBoD,GAAjB,CAAqB,QAArB;AACD;;AAED,SAASP,iBAAT,CAA2B1C,EAA3B,EAA+B;AAAA,oBACNA,GAAGC,OADG;AAAA,MACrBR,EADqB,eACrBA,EADqB;AAAA,MACjBC,MADiB,eACjBA,MADiB;;AAE7BF,mBAAiB,EAAEC,MAAF,EAAMC,cAAN,EAAjB;AACD;;AAED,SAAS+C,SAAT,CAAmBzC,EAAnB,EAAuB;AAAA,qBACEA,GAAGC,OADL;AAAA,MACbP,MADa,gBACbA,MADa;AAAA,MACLD,EADK,gBACLA,EADK;;AAErB,SAAOT,kCAAgCU,MAAhC,SAA0CD,EAA1C,EAAgD;AACrDR,iBAAa,aADwC;AAErDC,aAAS;AACP,sBAAgB;AADT;AAF4C,GAAhD,CAAP;AAMD;;AAED,SAASgE,cAAT,CAAwBC,OAAxB,EAAiC;AAC/BC,IAAEC,GAAF,CAAMC,QAAN,CAAkBC,OAAOC,QAAP,CAAgBC,MAAlC,qBAAwDN,OAAxD;AACD;;AAED,SAAStB,eAAT,CAAyBnD,EAAzB,EAA6B;AAAA;AAAA;AAAA;;AAAA;AAC3B,yBAAeF,OAAf,8HAAwB;AAAA,UAAfwB,EAAe;;AACtB,UAAI,0BAAWA,EAAX,CAAJ,EAAoB;AAClBD,oBAAYC,EAAZ;AACD;AACF;AAL0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAM5B;;AAED,IAAI0D,YAAJ;AACA,IAAIhC,eAAJ;AACA,IAAIiC,eAAJ;AACA,IAAMC,mBAAmB,yBAASnF,OAAT,EAAkB,GAAlB,EAAuB,IAAvB,CAAzB;AACA,IAAMoF,2BAA2B,yBAAShC,eAAT,EAA0B,GAA1B,EAA+B,KAA/B,CAAjC;;AAEO,SAAS9D,UAAT,GAAsB;AAC3B2F,QAAMvF,SAASI,cAAT,CAAwB,oBAAxB,CAAN;AACAmD,WAASvD,SAASC,sBAAT,CAAgC,wBAAhC,EAA0D,CAA1D,CAAT;AACAuF,WAASxF,SAASC,sBAAT,CAAgC,qBAAhC,EAAuD,CAAvD,CAAT;AACAsF,MAAII,gBAAJ,CAAqB,OAArB,EAA8BF,gBAA9B;AACAlC,SAAOoC,gBAAP,CAAwB,OAAxB,EAAiC5B,aAAjC;AACAyB,SAAOG,gBAAP,CAAwB,OAAxB,EAAiC5B,aAAjC;AACAqB,SAAOO,gBAAP,CAAwB,QAAxB,EAAkCD,wBAAlC;AACD;AACM,SAAS7F,aAAT,GAAyB;AAC9B0F,MAAIK,mBAAJ,CAAwB,OAAxB,EAAiCH,gBAAjC;AACAlC,SAAOqC,mBAAP,CAA2B,OAA3B,EAAoC7B,aAApC;AACAyB,SAAOI,mBAAP,CAA2B,OAA3B,EAAoC7B,aAApC;AACAqB,SAAOQ,mBAAP,CAA2B,QAA3B,EAAqCF,wBAArC;AACA;AACD,C;;;;;;;;;;;;;;;;;;kBC9PuBG,Y;AAAT,SAASA,YAAT,CAAsBC,IAAtB,EAA4B;AACzC,MAAMC,WAAWD,KAAKE,qBAAL,EAAjB;AACA,SACED,SAASE,GAAT,IAAgB,CAAhB,IACAF,SAASG,IAAT,IAAiB,CADjB,IAEAH,SAASI,MAAT,KACGf,OAAOgB,WAAP,IAAsBpG,SAASqG,eAAT,CAAyBC,YADlD,CAFA,IAIAP,SAASQ,KAAT,KACGnB,OAAOoB,UAAP,IAAqBxG,SAASqG,eAAT,CAAyBI,WADjD,CALF;AAQD,C;;;;;;;;;;;;;;;ACVD;;AACA,CAAC,YAAW;AACVxB,IAAEyB,IAAF,CAAOzB,EAAE0B,EAAF,CAAKC,WAAZ;AACA3B,IAAE4B,OAAF,CAAU5B,EAAE0B,EAAF,CAAKC,WAAf;AACD,CAHD,I;;;;;;;;;;;;;;;;;;QCDgBE,O,GAAAA,O;QAGAC,Q,GAAAA,Q;QAIAC,Q,GAAAA,Q;QASAC,c,GAAAA,c;QAUAC,O,GAAAA,O;QAYAC,Q,GAAAA,Q;QAYAC,W,GAAAA,W;QAeAC,Q,GAAAA,Q;QAeAC,Y,GAAAA,Y;QAKAC,Y,GAAAA,Y;AArFT,SAAST,OAAT,CAAkBU,GAAlB,EAAuB;AAC5B,SAAOC,OAAOC,IAAP,CAAYF,GAAZ,EAAiB9G,MAAjB,KAA4B,CAAnC;AACD;AACM,SAASqG,QAAT,CAAmBS,GAAnB,EAAwB;AAC7B,SAAOG,KAAKC,KAAL,CAAWD,KAAKE,SAAL,CAAeL,GAAf,CAAX,CAAP;AACD;AACD;AACO,SAASR,QAAT,GAAoC;AAAA,MAAjBc,IAAiB,uEAAV,EAAU;AAAA,MAANC,IAAM;;AACzC,MAAIC,SAASL,KAAKC,KAAL,CAAWD,KAAKE,SAAL,CAAeC,IAAf,CAAX,CAAb;AACA,OAAK,IAAIG,GAAT,IAAgBF,IAAhB,EAAsB;AACpB,QAAIA,KAAKG,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC5BD,aAAOC,GAAP,IAAcF,KAAKE,GAAL,CAAd;AACD;AACF;AACD,SAAOD,MAAP;AACD;AACM,SAASf,cAAT,CAAyBO,GAAzB,EAA8BW,MAA9B,EAAsC;AAC3C,MAAI,CAACA,MAAL,EAAa,OAAOX,GAAP;AACb,MAAIQ,SAAS,EAAb;AACA,OAAK,IAAIC,GAAT,IAAgBT,GAAhB,EAAqB;AACnB,QAAIA,IAAIU,cAAJ,CAAmBD,GAAnB,CAAJ,EAA6B;AAC3BD,aAAO,KAAKG,MAAL,GAAc,GAAd,GAAoBF,GAApB,GAA0B,GAAjC,IAAwCT,IAAIS,GAAJ,CAAxC;AACD;AACF;AACD,SAAOD,MAAP;AACD;AACM,SAASd,OAAT,CAAkBM,GAAlB,EAAuBY,OAAvB,EAAgC;AACrC,MAAI,CAACA,OAAL,EAAc,OAAOZ,GAAP;AACd,MAAIQ,SAAS,EAAb;AACAA,SAAOI,OAAP,IAAkB,EAAlB;AACA,OAAK,IAAIH,GAAT,IAAgBT,GAAhB,EAAqB;AACnB,QAAIA,IAAIU,cAAJ,CAAmBD,GAAnB,CAAJ,EAA6B;AAC3BD,aAAOI,OAAP,EAAgBH,GAAhB,IAAuBT,IAAIS,GAAJ,CAAvB;AACD;AACF;AACD,SAAOD,MAAP;AACD;;AAEM,SAASb,QAAT,CAAmBvD,GAAnB,EAAwB;AAC7B,MAAIyE,SAASrI,SAASsI,aAAT,CAAuB,KAAvB,CAAb;AACAD,SAAO5G,SAAP,GAAmBmC,GAAnB;AACA,MAAI2E,YAAYF,OAAOjG,QAAP,CAAgB,CAAhB,CAAhB;AACA,SAAOmG,SAAP;AACD;AACD;;;;;;AAMO,SAASnB,WAAT,CAAsBoB,OAAtB,EAA+BC,aAA/B,EAA8C;AACnDA,gBAAcC,UAAd,CAAyBC,YAAzB,CAAsCH,OAAtC,EAA+CC,cAAcG,WAA7D;AACD;;AAED;AACA;AACA;AACA;AACA;;;;;;;AAOO,SAASvB,QAAT,CAAmBwB,IAAnB,EAAyBC,IAAzB,EAA+BC,SAA/B,EAA0C;AAC/C,MAAIC,OAAJ;AACA,SAAO,YAAY;AACjB,QAAIC,UAAU,IAAd;AAAA,QAAoBC,OAAOC,SAA3B;AACA,QAAIC,QAAQ,SAARA,KAAQ,GAAY;AACtBJ,gBAAU,IAAV;AACA,UAAI,CAACD,SAAL,EAAgBF,KAAKQ,KAAL,CAAWJ,OAAX,EAAoBC,IAApB;AACjB,KAHD;AAIA,QAAII,UAAUP,aAAa,CAACC,OAA5B;AACAO,iBAAaP,OAAb;AACAA,cAAUQ,WAAWJ,KAAX,EAAkBN,IAAlB,CAAV;AACA,QAAIQ,OAAJ,EAAaT,KAAKQ,KAAL,CAAWJ,OAAX,EAAoBC,IAApB;AACd,GAVD;AAWD;;AAEM,SAAS5B,YAAT,GAAyB;AAC9B,MAAImC,WAAY,YAAY;AAAE,WAAO,CAAC,IAAR;AAAc,GAA7B,EAAf;AACA,SAAOA,QAAP;AACD;;AAEM,SAASlC,YAAT,GAAyB;AAC9B,SAAO,uCAAuCmC,OAAvC,CAA+C,OAA/C,EAAwD,UAAUC,CAAV,EAAa;AAC1E,QAAIC,IAAIC,KAAKC,MAAL,KAAgB,EAAhB,GAAqB,CAA7B;AAAA,QAAgCC,IAAIJ,KAAK,GAAL,GAAWC,CAAX,GAAgBA,IAAI,GAAJ,GAAU,GAA9D;AACA,WAAOG,EAAEC,QAAF,CAAW,EAAX,CAAP;AACD,GAHM,CAAP;AAID,C;;;;;;;;;;;;;;;;;;QCzEeC,a,GAAAA,a;QASAC,Y,GAAAA,Y;AA1BhB;AACA;AACA,IAAIxC,OAAO,EAAC,IAAI,CAAL,EAAQ,IAAI,CAAZ,EAAe,IAAI,CAAnB,EAAsB,IAAI,CAA1B,EAAX;;AAEA,SAAS/C,cAAT,CAAyBwF,CAAzB,EAA4B;AAC1BA,MAAIA,KAAK/E,OAAOgF,KAAhB;AACA,MAAID,EAAExF,cAAN,EAAsB;AAAEwF,MAAExF,cAAF;AAAoB;AAC5CwF,IAAEE,WAAF,GAAgB,KAAhB;AACD;;AAED,SAASC,2BAAT,CAAsCH,CAAtC,EAAyC;AACvC,MAAIzC,KAAKyC,EAAEI,OAAP,CAAJ,EAAqB;AACnB5F,mBAAewF,CAAf;AACA,WAAO,KAAP;AACD;AACF;;AAEM,SAASF,aAAT,GAA0B;AAC/B,MAAI7E,OAAOO,gBAAX,EAA6B;AAC3B;AAAEP,aAAOO,gBAAP,CAAwB,gBAAxB,EAA0ChB,cAA1C,EAA0D,KAA1D;AAAkE;AACtES,SAAOoF,OAAP,GAAiB7F,cAAjB,CAH+B,CAGC;AAChCS,SAAOqF,YAAP,GAAsBzK,SAASyK,YAAT,GAAwB9F,cAA9C,CAJ+B,CAI8B;AAC7DS,SAAOsF,WAAP,GAAqB/F,cAArB,CAL+B,CAKK;AACpC3E,WAAS2K,SAAT,GAAqBL,2BAArB;AACD;;AAEM,SAASJ,YAAT,GAAyB;AAC9B,MAAI9E,OAAOQ,mBAAX,EAAgC;AAAER,WAAOQ,mBAAP,CAA2B,gBAA3B,EAA6CjB,cAA7C,EAA6D,KAA7D;AAAqE;AACvGS,SAAOqF,YAAP,GAAsBzK,SAASyK,YAAT,GAAwB,IAA9C;AACArF,SAAOoF,OAAP,GAAiB,IAAjB;AACApF,SAAOsF,WAAP,GAAqB,IAArB;AACA1K,WAAS2K,SAAT,GAAqB,IAArB;AACD,C","file":"ptTask.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/dawn/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 153);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 68dfebe0fd0d5ad30a12","import { debounce } from \"../common/utilities\";\nimport inViewport from \"../common/inViewport\";\nimport { disableScroll, enableScroll } from \"../common/toggleScroll\";\nconst stack = [];\nconst torrentDetailEl = document.getElementsByClassName(\n  \"torrent-detail-popup\"\n)[0];\nconst torrentDetailWrapEl = document.getElementsByClassName(\n  \"torrent-detail-wrap\"\n)[0];\nconst searchInputEl = document.getElementById(\"pt-tasks-q\");\n\nlet ptTasks = [];\nfunction queryId(ev) {\n  const q = searchInputEl.value;\n  if (!q.length) {\n    renderList([]);\n    return;\n  }\n  stack.push(q);\n  fetch(`/pt_task_search?q=${q}`, {\n    credentials: \"same-origin\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  })\n    .then(res => res.json())\n    .then(data => {\n      shouldContinue(data, q);\n    });\n}\n\nfunction getTorrentDetail({ id, source }) {\n  if (id == null || source == null) {\n    return;\n  }\n  fetch(`/pt_task_torrent_detail?id=${id}&source=${source}`, {\n    credentials: \"same-origin\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  })\n    .then(res => res.text())\n    .then(data => {\n      torrentDetailEl.innerHTML = data;\n      torrentDetailWrapEl.classList.remove(\"c-hide\");\n    });\n}\n\nfunction getTtgCover(el) {\n  const id = el.dataset.id;\n  const source = el.dataset.source;\n  const coverEl = Array.prototype.slice\n    .call(el.children)\n    .filter(el => el.classList.contains(\"pt-task-cover\"))[0];\n  if (coverEl.style.backgroundImage.indexOf(\"ttg_logo\") === -1) {\n    return;\n  }\n  return fetch(`/pt_task_ttg_cover?id=${id}&source=${source}`, {\n    credentials: \"same-origin\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  })\n    .then(res => res.text())\n    .then(data => {\n      if (data == null || data === \"null\" || data === \"\") {\n        return;\n      }\n      coverEl.style.backgroundImage = `url(${data})`;\n    });\n}\nfunction shouldContinue(data, q) {\n  if (stack.length > 0 && q === stack[stack.length - 1]) {\n    renderList(data);\n  }\n}\nfunction renderList(arr) {\n  const res = [];\n  arr.forEach(el => {\n    res.push(`\n      <div class=\"per-pt-task c-border c-center c-padding ${\n        el.torrentSource ? el.torrentSource : \"\"\n      } ${checkAvailability(el) ? \"\" : \"not-available\"}\" data-id=\"${\n      el.torrentId\n    }\" data-source=\"${el.torrentSource}\">\n        <div class=\"pt-task-cover\" style=\"background-image: url(${\n          el.coverPic\n        }); \">\n        </div>\n        <div class=\"pt-task-info\">\n            <h3>${el.chsTitle}</h3>\n            <h3>${el.engTitle}</h3>\n            <div class=\"torrent-status-info\">\n                <span class=\"torrent-category c-pad-sm\">种子类型: ${\n                  el.torrentCategory\n                }</span>\n                <span class=\"torrent-size c-pad-sm\">文件大小: <b>${\n                  el.torrentSize\n                }</b></span>\n                <span class=\"torrent-seeders c-pad-sm\">做种数量: <b>${\n                  el.peersCount\n                }</b></span>\n                <span class=\"torrent-downloading c-pad-sm\">正在下载数量: <b>${\n                  el.downloadingCount\n                }</b></span>\n            </div>\n        </div>\n        <div class=\"pt-source-op\">\n          <span class=\"pt-source c-pad-sm c-center\">种子来源: ${\n            el.torrentSource\n          }</span>\n          <span class=\"c-center c-gap-top c-pad-sm pt-torrent-detail c-pointer\"\n          data-source=\"${el.torrentSource}\"\n          data-id=\"${el.torrentId}\">种子详情</span>\n          ${checkAvailability(el) ? addTaskHtml(el) : \"\"}\n        </div>\n      </div>\n    `);\n  });\n  resEle.innerHTML = res.join(\"\");\n  ptTasks = Array.prototype.slice.call(\n    document.querySelectorAll(\".per-pt-task.ttg\")\n  );\n  checkInViewport();\n  //   disableScroll();\n}\n\nfunction addTaskHtml(el) {\n  return `<div class=\"add-pt-task c-pad-sm c-center c-gap-top c-pointer\" data-id='${\n    el.torrentId\n  }' data-source=\"${el.torrentSource}\">添加到任务</div>`;\n}\n\nfunction checkAvailability(el) {\n  if (el.peersCount > 0 && validSize(el.torrentSize)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction validSize(str) {\n  const regex = /(\\d*\\.*\\d*)(.*)/;\n  const res = regex.exec(str);\n  if (res[2] === \"GB\") {\n    if (+res[1] > 10) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction delegateClick(ev) {\n  const evt = ev.target;\n  let apt, ptd, tdpc;\n  // add pt task\n  if (evt.classList.contains(\"add-pt-task\")) {\n    apt = evt;\n  } else {\n    apt = evt.closest(\".add-pt-task\");\n  }\n  if (apt) {\n    addPtTask(apt);\n    return;\n  }\n\n  // torrentDetail\n  if (evt.classList.contains(\"pt-torrent-detail\")) {\n    ptd = evt;\n  } else {\n    ptd = evt.closest(\".pt-torrent-detail\");\n  }\n  if (ptd) {\n    showTorrentDetail(ptd);\n    return;\n  }\n\n  // popup\n  if (evt.classList.contains(\"torrent-detail-popup-close\")) {\n    tdpc = evt;\n  } else {\n    tdpc = evt.closest(\".torrent-detail-popup-close\");\n  }\n  if (tdpc) {\n    closePopup(tdpc);\n    return;\n  }\n\n  // disable link in popup\n  if (evt.tagName === \"A\" && evt.closest(\".torrent-detail-popup\")) {\n    forbidExtLink(ev);\n    return;\n  }\n}\n\nfunction forbidExtLink(ev) {\n  ev.preventDefault();\n  alert(\"external link disabled.\");\n}\n\nfunction closePopup(el) {\n  const wrapEl = el.closest(\".torrent-detail-wrap\");\n  wrapEl.classList.add(\"c-hide\");\n}\n\nfunction showTorrentDetail(el) {\n  const { id, source } = el.dataset;\n  getTorrentDetail({ id, source });\n}\n\nfunction addPtTask(el) {\n  const { source, id } = el.dataset;\n  return fetch(`/pt_task_add?source_id=${source}_${id}`, {\n    credentials: \"same-origin\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n}\n\nfunction goToTaskDetail(task_id) {\n  A.spf.navigate(`${window.location.origin}/pt_tasks?id=${task_id}`);\n}\n\nfunction checkInViewport(ev) {\n  for (let el of ptTasks) {\n    if (inViewport(el)) {\n      getTtgCover(el);\n    }\n  }\n}\n\nlet ele;\nlet resEle;\nlet tdWrap;\nconst debouncedQueryId = debounce(queryId, 400, true);\nconst debouncedCheckInViewport = debounce(checkInViewport, 300, false);\n\nexport function initPtTask() {\n  ele = document.getElementById(\"pt-task-search-btn\");\n  resEle = document.getElementsByClassName(\"pt-tasks-search-result\")[0];\n  tdWrap = document.getElementsByClassName(\"torrent-detail-wrap\")[0];\n  ele.addEventListener(\"click\", debouncedQueryId);\n  resEle.addEventListener(\"click\", delegateClick);\n  tdWrap.addEventListener(\"click\", delegateClick);\n  window.addEventListener(\"scroll\", debouncedCheckInViewport);\n}\nexport function disposePtTask() {\n  ele.removeEventListener(\"click\", debouncedQueryId);\n  resEle.removeEventListener(\"click\", delegateClick);\n  tdWrap.removeEventListener(\"click\", delegateClick);\n  window.removeEventListener(\"scroll\", debouncedCheckInViewport);\n  enableScroll();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/packs/modules/ptTask.js","export default function isInViewport(elem) {\n  const bounding = elem.getBoundingClientRect();\n  return (\n    bounding.top >= 0 &&\n    bounding.left >= 0 &&\n    bounding.bottom <=\n      (window.innerHeight || document.documentElement.clientHeight) &&\n    bounding.right <=\n      (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/packs/common/inViewport.js","import { initPtTask, disposePtTask } from \"../modules/ptTask\";\n(function() {\n  A.init[A.gc.currentName] = initPtTask;\n  A.destroy[A.gc.currentName] = disposePtTask;\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/packs/entries/ptTask.js","export function isEmpty (obj) {\n  return Object.keys(obj).length === 0\n}\nexport function cloneObj (obj) {\n  return JSON.parse(JSON.stringify(obj))\n}\n/* consider Object.assign(target, ...sources) */\nexport function mergeObj (obj1 = {}, obj2) {\n  let newObj = JSON.parse(JSON.stringify(obj1))\n  for (let key in obj2) {\n    if (obj2.hasOwnProperty(key)) {\n      newObj[key] = obj2[key]\n    }\n  }\n  return newObj\n}\nexport function addPrefixToObj (obj, prefix) {\n  if (!prefix) return obj\n  let newObj = {}\n  for (let key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      newObj['' + prefix + '[' + key + ']'] = obj[key]\n    }\n  }\n  return newObj\n}\nexport function wrapObj (obj, wrapper) {\n  if (!wrapper) return obj\n  var newObj = {}\n  newObj[wrapper] = {}\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      newObj[wrapper][key] = obj[key]\n    }\n  }\n  return newObj\n}\n\nexport function strToDom (str) {\n  let tmpEle = document.createElement('div')\n  tmpEle.innerHTML = str\n  let returnDom = tmpEle.children[0]\n  return returnDom\n}\n/**\n * [insertAfter description: According to MDN if the element is last (and so nextSibling is null) the newNode will be appended as expected]\n * @param  {[type]} newNode       [description]\n * @param  {[type]} referenceNode [description]\n * @return {undefined}               [description]\n */\nexport function insertAfter (newNode, referenceNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling)\n}\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n/*\nvar myEfficientFn = debounce(function() {\n  // All the taxing stuff you do\n}, 250);\n\nwindow.addEventListener('resize', myEfficientFn);\n */\nexport function debounce (func, wait, immediate) {\n  var timeout\n  return function () {\n    var context = this, args = arguments\n    var later = function () {\n      timeout = null\n      if (!immediate) func.apply(context, args)\n    }\n    var callNow = immediate && !timeout\n    clearTimeout(timeout)\n    timeout = setTimeout(later, wait)\n    if (callNow) func.apply(context, args)\n  }\n};\n\nexport function isStrictMode () {\n  var isStrict = (function () { return !this })()\n  return isStrict\n}\n\nexport function generateUUID () {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    let r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8)\n    return v.toString(16)\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/packs/common/utilities.js","// left: 37, up: 38, right: 39, down: 40,\n// spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36\nvar keys = {37: 1, 38: 1, 39: 1, 40: 1}\n\nfunction preventDefault (e) {\n  e = e || window.event\n  if (e.preventDefault) { e.preventDefault() }\n  e.returnValue = false\n}\n\nfunction preventDefaultForScrollKeys (e) {\n  if (keys[e.keyCode]) {\n    preventDefault(e)\n    return false\n  }\n}\n\nexport function disableScroll () {\n  if (window.addEventListener) // older FF\n    { window.addEventListener('DOMMouseScroll', preventDefault, false) }\n  window.onwheel = preventDefault // modern standard\n  window.onmousewheel = document.onmousewheel = preventDefault // older browsers, IE\n  window.ontouchmove = preventDefault // mobile\n  document.onkeydown = preventDefaultForScrollKeys\n}\n\nexport function enableScroll () {\n  if (window.removeEventListener) { window.removeEventListener('DOMMouseScroll', preventDefault, false) }\n  window.onmousewheel = document.onmousewheel = null\n  window.onwheel = null\n  window.ontouchmove = null\n  document.onkeydown = null\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/packs/common/toggleScroll.js"],"sourceRoot":""}